"use strict";class Util{forEach(a,b){a=a||[];for(let c=0;c<a.length;c++)b(a[c])}getScrollTop(){return document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop}isMobile(){return window.matchMedia("only screen and (max-width: 680px)").matches}isTocStatic(){return window.matchMedia("only screen and (max-width: 960px)").matches}animateCSS(a,b,c,d){Array.isArray(b)||(b=[b]),a.classList.add("animated",...b);const e=()=>{a.classList.remove("animated",...b),a.removeEventListener("animationend",e),"function"==typeof d&&d()};c||a.addEventListener("animationend",e,!1)}}class Theme{constructor(){this.config=window.config,this.data=this.config.data,this.isDark="dark"===document.body.getAttribute("theme"),this.util=new Util,this.newScrollTop=this.util.getScrollTop(),this.oldScrollTop=this.newScrollTop,this.scrollEventSet=new Set,this.resizeEventSet=new Set,this.switchThemeEventSet=new Set,this.clickMaskEventSet=new Set,window.objectFitImages&&objectFitImages()}initSVGIcon(){this.util.forEach(document.querySelectorAll("[data-svg-src]"),a=>{fetch(a.getAttribute("data-svg-src")).then(a=>a.text()).then(b=>{const c=document.createElement("div");c.insertAdjacentHTML("afterbegin",b);const d=c.firstChild;d.setAttribute("data-svg-src",a.getAttribute("data-svg-src")),d.classList.add("icon");const e=d.getElementsByTagName("title");e.length&&d.removeChild(e[0]),a.parentElement.replaceChild(d,a)}).catch(a=>{console.error(a)})})}initTwemoji(){this.config.twemoji&&twemoji.parse(document.body)}initMenuMobile(){const a=document.getElementById("menu-toggle-mobile"),b=document.getElementById("menu-mobile");a.addEventListener("click",()=>{document.body.classList.toggle("blur"),a.classList.toggle("active"),b.classList.toggle("active")},!1),this._menuMobileOnClickMask=this._menuMobileOnClickMask||(()=>{a.classList.remove("active"),b.classList.remove("active")}),this.clickMaskEventSet.add(this._menuMobileOnClickMask)}initSwitchTheme(){this.util.forEach(document.getElementsByClassName("theme-switch"),a=>{a.addEventListener("click",()=>{"dark"===document.body.getAttribute("theme")?document.body.setAttribute("theme","light"):document.body.setAttribute("theme","dark"),this.isDark=!this.isDark,window.localStorage&&localStorage.setItem("theme",this.isDark?"dark":"light");for(let a of this.switchThemeEventSet)a()},!1)})}initSearch(){const a=this.config.search,b=this.util.isMobile();if(!a||b&&this._searchMobileOnce||!b&&this._searchDesktopOnce)return;const c=a.maxResultLength?a.maxResultLength:10,d=a.snippetLength?a.snippetLength:50,e=a.highlightTag?a.highlightTag:"em",f=b?"mobile":"desktop",g=document.getElementById(`header-${f}`),h=document.getElementById(`search-input-${f}`),i=document.getElementById(`search-toggle-${f}`),j=document.getElementById(`search-loading-${f}`),k=document.getElementById(`search-clear-${f}`);b?(this._searchMobileOnce=!0,h.addEventListener("focus",()=>{document.body.classList.add("blur"),g.classList.add("open")},!1),document.getElementById("search-cancel-mobile").addEventListener("click",()=>{g.classList.remove("open"),document.body.classList.remove("blur"),document.getElementById("menu-toggle-mobile").classList.remove("active"),document.getElementById("menu-mobile").classList.remove("active"),j.style.display="none",k.style.display="none",this._searchMobile&&this._searchMobile.autocomplete.setVal("")},!1),k.addEventListener("click",()=>{k.style.display="none",this._searchMobile&&this._searchMobile.autocomplete.setVal("")},!1),this._searchMobileOnClickMask=this._searchMobileOnClickMask||(()=>{g.classList.remove("open"),j.style.display="none",k.style.display="none",this._searchMobile&&this._searchMobile.autocomplete.setVal("")}),this.clickMaskEventSet.add(this._searchMobileOnClickMask)):(this._searchDesktopOnce=!0,i.addEventListener("click",()=>{document.body.classList.add("blur"),g.classList.add("open"),h.focus()},!1),k.addEventListener("click",()=>{k.style.display="none",this._searchDesktop&&this._searchDesktop.autocomplete.setVal("")},!1),this._searchDesktopOnClickMask=this._searchDesktopOnClickMask||(()=>{g.classList.remove("open"),j.style.display="none",k.style.display="none",this._searchDesktop&&this._searchDesktop.autocomplete.setVal("")}),this.clickMaskEventSet.add(this._searchDesktopOnClickMask)),h.addEventListener("input",()=>{k.style.display=""===h.value?"none":"inline"},!1);const l=()=>{const g=autocomplete(`#search-input-${f}`,{hint:!1,autoselect:!0,dropdownMenuContainer:`#search-dropdown-${f}`,clearOnSelected:!0,cssClasses:{noPrefix:!0},debug:!0},{name:"search",source:(b,f)=>{j.style.display="inline",k.style.display="none";const g=a=>{j.style.display="none",k.style.display="inline",f(a)};if("lunr"===a.type){const f=()=>{lunr.queryHandler&&(b=lunr.queryHandler(b));const a={};return this._index.search(b).forEach(b=>{let{ref:c,matchData:{metadata:f}}=b;const g=this._indexData[c];let{uri:h,title:i,content:j}=g;if(a[h])return;let k=0;Object.values(f).forEach(a=>{let{content:b}=a;if(b){const a=b.position[0][0];(a<k||0===k)&&(k=a)}}),k-=d/5,0<k?(k+=j.substr(k,20).lastIndexOf(" ")+1,j="..."+j.substr(k,d)):j=j.substr(0,d),Object.keys(f).forEach(a=>{i=i.replace(new RegExp(`(${a})`,"gi"),`<${e}>$1</${e}>`),j=j.replace(new RegExp(`(${a})`,"gi"),`<${e}>$1</${e}>`)}),a[h]={uri:h,title:i,date:g.date,context:j}}),Object.values(a).slice(0,c)};this._index?g(f()):fetch(a.lunrIndexURL).then(a=>a.json()).then(b=>{const c={};this._index=lunr(function(){a.lunrLanguageCode&&this.use(lunr[a.lunrLanguageCode]),this.ref("objectID"),this.field("title",{boost:50}),this.field("tags",{boost:20}),this.field("categories",{boost:20}),this.field("content",{boost:10}),this.metadataWhitelist=["position"],b.forEach(a=>{c[a.objectID]=a,this.add(a)})}),this._indexData=c,g(f())}).catch(a=>{console.error(a),g([])})}else"algolia"===a.type&&(this._algoliaIndex=this._algoliaIndex||algoliasearch(a.algoliaAppID,a.algoliaSearchKey).initIndex(a.algoliaIndex),this._algoliaIndex.search(b,{offset:0,length:8*c,attributesToHighlight:["title"],attributesToSnippet:[`content:${d}`],highlightPreTag:`<${e}>`,highlightPostTag:`</${e}>`}).then(a=>{let{hits:b}=a;const d={};b.forEach(a=>{let{uri:b,date:c,_highlightResult:{title:e},_snippetResult:{content:f}}=a;d[b]&&d[b].context.length>f.value||(d[b]={uri:b,title:e.value,date:c,context:f.value})}),g(Object.values(d).slice(0,c))}).catch(a=>{console.error(a),g([])}))},templates:{suggestion:a=>{let{title:b,date:c,context:d}=a;return`<div><span class="suggestion-title">${b}</span><span class="suggestion-date">${c}</span></div><div class="suggestion-context">${d}</div>`},empty:b=>{let{query:c}=b;return`<div class="search-empty">${a.noResultsFound}: <span class="search-query">"${c}"</span></div>`},footer:b=>{let{}=b;const{searchType:c,icon:d,href:e}="algolia"===a.type?{searchType:"algolia",icon:"<i class=\"fab fa-algolia fa-fw\"></i>",href:"https://www.algolia.com/"}:{searchType:"Lunr.js",icon:"",href:"https://lunrjs.com/"};return`<div class="search-footer">Search by <a href="${e}" rel="noopener noreffer" target="_blank">${d} ${c}</a></div>`}}});g.on("autocomplete:selected",(a,b)=>{window.location.assign(b.uri)}),b?this._searchMobile=g:this._searchDesktop=g};if(a.lunrSegmentitURL&&!document.getElementById("lunr-segmentit")){const b=document.createElement("script");b.id="lunr-segmentit",b.type="text/javascript",b.src=a.lunrSegmentitURL,b.async=!0,b.readyState?b.onreadystatechange=()=>{("loaded"==b.readyState||"complete"==b.readyState)&&(b.onreadystatechange=null,l())}:b.onload=()=>{l()},document.body.appendChild(b)}else l()}initDetails(){this.util.forEach(document.getElementsByClassName("details"),a=>{const b=a.getElementsByClassName("details-summary")[0];b.addEventListener("click",()=>{a.classList.toggle("open")},!1)})}initLightGallery(){this.config.lightGallery&&lightGallery(document.getElementById("content"),this.config.lightGallery)}initHighlight(){this.util.forEach(document.querySelectorAll(".highlight > pre.chroma"),a=>{const b=document.createElement("div");b.className=a.className;const c=document.createElement("table");b.appendChild(c);const d=document.createElement("tbody");c.appendChild(d);const e=document.createElement("tr");d.appendChild(e);const f=document.createElement("td");e.appendChild(f),a.parentElement.replaceChild(b,a),f.appendChild(a)}),this.util.forEach(document.querySelectorAll(".highlight > .chroma"),a=>{const b=a.querySelectorAll("pre.chroma > code");if(b.length){const c=b[b.length-1],d=document.createElement("div");d.className="code-header "+c.className.toLowerCase();const e=document.createElement("span");e.classList.add("code-title"),e.insertAdjacentHTML("afterbegin","<i class=\"arrow fas fa-chevron-right fa-fw\"></i>"),e.addEventListener("click",()=>{a.classList.toggle("open")},!1),d.appendChild(e);const f=document.createElement("span");f.insertAdjacentHTML("afterbegin","<i class=\"fas fa-ellipsis-h fa-fw\"></i>"),f.classList.add("ellipses"),f.addEventListener("click",()=>{a.classList.add("open")},!1),d.appendChild(f);const g=document.createElement("span");g.insertAdjacentHTML("afterbegin","<i class=\"far fa-copy fa-fw\"></i>"),g.classList.add("copy");const h=c.innerText;if((0>this.config.code.maxShownLines||h.split("\n").length<this.config.code.maxShownLines+2)&&a.classList.add("open"),this.config.code.copyTitle){g.setAttribute("data-clipboard-text",h),g.title=this.config.code.copyTitle;const a=new ClipboardJS(g);a.on("success",()=>{this.util.animateCSS(c,"flash")}),d.appendChild(g)}a.insertBefore(d,a.firstChild)}})}initTable(){this.util.forEach(document.querySelectorAll(".content table"),a=>{const b=document.createElement("div");b.className="table-wrapper",a.parentElement.replaceChild(b,a),b.appendChild(a)})}initHeaderLink(){for(let a=1;6>=a;a++)this.util.forEach(document.querySelectorAll(".single .content > h"+a),a=>{a.classList.add("headerLink"),a.insertAdjacentHTML("afterbegin",`<a href="#${a.id}" class="header-mark"></a>`)})}initToc(){const a=document.getElementById("TableOfContents");if(null!==a)if(document.getElementById("toc-static").getAttribute("kept")||this.util.isTocStatic()){const b=document.getElementById("toc-content-static");a.parentElement!==b&&(a.parentElement.removeChild(a),b.appendChild(a)),this._tocOnScroll&&this.scrollEventSet.delete(this._tocOnScroll)}else{const b=document.getElementById("toc-content-auto");a.parentElement!==b&&(a.parentElement.removeChild(a),b.appendChild(a));const c=document.getElementById("toc-auto"),d=document.getElementsByClassName("page")[0],e=d.getBoundingClientRect();c.style.left=`${e.left+e.width+20}px`,c.style.maxWidth=`${d.getBoundingClientRect().left-20}px`,c.style.visibility="visible";const f=a.querySelectorAll("a:first-child"),g=a.getElementsByTagName("li"),h=document.getElementsByClassName("headerLink"),i="normal"!==document.body.getAttribute("header-desktop"),j=document.getElementById("header-desktop").offsetHeight,k=20+(i?j:0),l=c.offsetTop,m=l-k+(i?0:j);this._tocOnScroll=this._tocOnScroll||(()=>{const b=document.getElementById("post-footer").offsetTop,d=b-c.getBoundingClientRect().height,e=d-k+(i?0:j);this.newScrollTop<m?(c.style.position="absolute",c.style.top=`${l}px`):this.newScrollTop>e?(c.style.position="absolute",c.style.top=`${d}px`):(c.style.position="fixed",c.style.top=`${k}px`),this.util.forEach(f,a=>{a.classList.remove("active")}),this.util.forEach(g,a=>{a.classList.remove("has-active")});const n=20+(i?j:0);let o=h.length-1;for(let a=0;a<h.length-1;a++){const b=h[a].getBoundingClientRect().top,c=h[a+1].getBoundingClientRect().top;if(0==a&&b>n||b<=n&&c>n){o=a;break}}if(-1!==o){f[o].classList.add("active");for(let b=f[o].parentElement;b!==a;)b.classList.add("has-active"),b=b.parentElement.parentElement}}),this._tocOnScroll(),this.scrollEventSet.add(this._tocOnScroll)}}initMath(){this.config.math&&renderMathInElement(document.body,this.config.math)}initMermaid(){const a=document.getElementsByClassName("mermaid");a.length&&(mermaid.initialize({startOnLoad:!1,theme:"null"}),this.util.forEach(a,a=>{mermaid.mermaidAPI.render("svg-"+a.id,this.data[a.id],b=>{a.insertAdjacentHTML("afterbegin",b)},a)}))}initEcharts(){this._echartsOnSwitchTheme=this._echartsOnSwitchTheme||(()=>{this._echartsArr=this._echartsArr||[];for(let a=0;a<this._echartsArr.length;a++)this._echartsArr[a].dispose();this._echartsArr=[],this.util.forEach(document.getElementsByClassName("echarts"),a=>{const b=echarts.init(a,this.isDark?"dark":"macarons",{renderer:"svg"});b.setOption(JSON.parse(this.data[a.id])),this._echartsArr.push(b)})}),this.switchThemeEventSet.add(this._echartsOnSwitchTheme),this._echartsOnSwitchTheme(),this._echartsOnResize=this._echartsOnResize||(()=>{for(let a=0;a<this._echartsArr.length;a++)this._echartsArr[a].resize()}),this.resizeEventSet.add(this._echartsOnResize)}initMapbox(){this.config.mapbox&&(mapboxgl.accessToken=this.config.mapbox.accessToken,mapboxgl.setRTLTextPlugin(this.config.mapbox.RTLTextPlugin),this._mapboxArr=this._mapboxArr||[],this.util.forEach(document.getElementsByClassName("mapbox"),a=>{const{lng:b,lat:c,zoom:d,lightStyle:e,darkStyle:f,marked:g,navigation:h,geolocate:i,scale:j,fullscreen:k}=this.data[a.id],l=new mapboxgl.Map({container:a,center:[b,c],zoom:d,minZoom:.2,style:this.isDark?f:e,attributionControl:!1});g&&new mapboxgl.Marker().setLngLat([b,c]).addTo(l),h&&l.addControl(new mapboxgl.NavigationControl,"bottom-right"),i&&l.addControl(new mapboxgl.GeolocateControl({positionOptions:{enableHighAccuracy:!0},showUserLocation:!0,trackUserLocation:!0}),"bottom-right"),j&&l.addControl(new mapboxgl.ScaleControl),k&&l.addControl(new mapboxgl.FullscreenControl),l.addControl(new MapboxLanguage),this._mapboxArr.push(l)}),this._mapboxOnSwitchTheme=this._mapboxOnSwitchTheme||(()=>{this.util.forEach(this._mapboxArr,a=>{const b=a.getContainer(),{lightStyle:c,darkStyle:d}=this.data[b.id];a.setStyle(this.isDark?d:c),a.addControl(new MapboxLanguage)})}),this.switchThemeEventSet.add(this._mapboxOnSwitchTheme))}initTypeit(){if(this.config.typeit){const a=this.config.typeit,b=a.speed?a.speed:100,c=a.cursorSpeed?a.cursorSpeed:1e3,d=a.cursorChar?a.cursorChar:"|";Object.values(a.data).forEach(e=>{const f=g=>{const h=e[g],i=new TypeIt(`#${h}`,{strings:this.data[h],speed:b,lifeLike:!0,cursorSpeed:c,cursorChar:d,waitUntilVisible:!0,afterComplete:()=>g===e.length-1?void(0<=a.duration&&window.setTimeout(()=>{i.destroy()},a.duration)):void(i.destroy(),f(g+1))}).go()};f(0)})}}initComment(){if(this.config.comment){if(this.config.comment.gitalk){this.config.comment.gitalk.body=decodeURI(window.location.href);const a=new Gitalk(this.config.comment.gitalk);a.render("gitalk")}if(this.config.comment.valine&&new Valine(this.config.comment.valine),this.config.comment.utterances){const a=this.config.comment.utterances,b=document.createElement("script");b.src="https://utteranc.es/client.js",b.type="text/javascript",b.setAttribute("repo",a.repo),b.setAttribute("issue-term",a.issueTerm),a.label&&b.setAttribute("label",a.label),b.setAttribute("theme",this.isDark?a.darkTheme:a.lightTheme),b.crossOrigin="anonymous",b.async=!0,document.getElementById("utterances").appendChild(b),this._utterancesOnSwitchTheme=this._utterancesOnSwitchTheme||(()=>{const b={type:"set-theme",theme:this.isDark?a.darkTheme:a.lightTheme},c=document.querySelector(".utterances-frame");c.contentWindow.postMessage(b,"https://utteranc.es")}),this.switchThemeEventSet.add(this._utterancesOnSwitchTheme)}}}initSmoothScroll(){SmoothScroll&&new SmoothScroll("[href^=\"#\"]",{speed:300,speedAsDuration:!0,header:"#header-desktop"})}initCookieconsent(){this.config.cookieconsent&&cookieconsent.initialise(this.config.cookieconsent)}onScroll(){const a=[];if("auto"===document.body.getAttribute("header-desktop")&&a.push(document.getElementById("header-desktop")),"auto"===document.body.getAttribute("header-mobile")&&a.push(document.getElementById("header-mobile")),document.getElementById("comments")){const a=document.getElementById("view-comments");a.href=`#comments`,a.style.display="block"}const b=document.getElementById("fixed-buttons"),c=20;window.addEventListener("scroll",()=>{this.newScrollTop=this.util.getScrollTop();const d=this.newScrollTop-this.oldScrollTop,e=this.util.isMobile();this.util.forEach(a,a=>{d>c?(a.classList.remove("fadeInDown"),this.util.animateCSS(a,["fadeOutUp","faster"],!0)):d<-c&&(a.classList.remove("fadeOutUp"),this.util.animateCSS(a,["fadeInDown","faster"],!0))}),this.newScrollTop>100?e&&d>c?(b.classList.remove("fadeIn"),this.util.animateCSS(b,["fadeOut","faster"],!0)):(!e||d<-c)&&(b.style.display="block",b.classList.remove("fadeOut"),this.util.animateCSS(b,["fadeIn","faster"],!0)):(!e&&(b.classList.remove("fadeIn"),this.util.animateCSS(b,["fadeOut","faster"],!0)),b.style.display="none");for(let a of this.scrollEventSet)a();this.oldScrollTop=this.newScrollTop},!1)}onResize(){window.addEventListener("resize",()=>{this._resizeTimeout||(this._resizeTimeout=window.setTimeout(()=>{this._resizeTimeout=null;for(let a of this.resizeEventSet)a();this.initToc(),this.initMermaid(),this.initSearch()},100))},!1)}onClickMask(){document.getElementById("mask").addEventListener("click",()=>{for(let a of this.clickMaskEventSet)a();document.body.classList.remove("blur")},!1)}init(){try{this.initSVGIcon(),this.initTwemoji(),this.initMenuMobile(),this.initSwitchTheme(),this.initSearch(),this.initDetails(),this.initLightGallery(),this.initHighlight(),this.initTable(),this.initHeaderLink(),this.initSmoothScroll(),this.initMath(),this.initMermaid(),this.initEcharts(),this.initTypeit(),this.initMapbox(),this.initCookieconsent()}catch(a){console.error(a)}window.setTimeout(()=>{this.initToc(),this.initComment(),this.onScroll(),this.onResize(),this.onClickMask()},100)}}const themeInit=()=>{const a=new Theme;a.init()};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",themeInit,!1):themeInit();

//# sourceMappingURL=theme.min.js.map